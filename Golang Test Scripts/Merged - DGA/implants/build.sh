#!/bin/sh
#
# build.sh
# Build a project

set -e

#Create build directory to output executables to
mkdir -p build
OUTPUTDIR="build"/

# go vet

for GOOS in windows linux openbsd darwin; do
	for GOARCH in 386 amd64; do
		for IMPLANTS in dns.go; do
			export GOOS GOARCH
			N="$OUTPUTDIR$IMPLANTS.$GOOS.$GOARCH"
			# Windows is special...
			if [ "windows" == $GOOS ]; then
				go build -o "$N.exe" "$IMPLANTS" 
				ls -l "$N.exe"
				go build -o "$N.nogui.exe" -ldflags "-H windowsgui" "$IMPLANTS"
				ls -l "$N.nogui.exe"
			else
				go build -o "$N" "$IMPLANTS" 
				ls -l $N
			fi
		done
	done
done

echo Done.